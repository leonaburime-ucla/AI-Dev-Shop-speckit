---
name: conventions
version: 1.0.0
last_updated: 2026-02-24
description: Output root, spec folder structure, and reports folder structure for all pipeline artifacts.
---

# Conventions

## Output Root

Spec files are written to the **user-specified location** — the Spec Agent asks before writing. Pipeline artifacts (ADR, research, tasks, test-certification, red-team findings, pipeline state) are written under `<SHOP_ROOT>/reports/pipeline/<NNN>-<feature-name>/`. Reports (analysis, test runs, code review, security, observer) live in `<SHOP_ROOT>/reports/` subfolders.

**Writable under `<SHOP_ROOT>`:** `reports/`, `project-knowledge/`
**Read-only under `<SHOP_ROOT>`:** `agents/`, `skills/`, `templates/`, `workflows/` — toolkit source files, never modify.

---

## Spec Folder Convention

Spec files live at the **user-specified location**, in a named subfolder:

```
<user-specified>/<NNN>-<feature-name>/
  feature.spec.md          (canonical spec — use templates/spec-system/feature.spec.md)
  api.spec.ts              (typed API contracts — if applicable)
  state.spec.ts            (state shapes and transitions — if applicable)
  orchestrator.spec.ts     (orchestrator output model — if applicable)
  ui.spec.ts               (UI component contracts — if applicable)
  errors.spec.ts           (error code registry — if applicable)
  behavior.spec.md         (deterministic behavior rules — if applicable)
  traceability.spec.md     (REQ-to-function-to-test matrix)
  checklists/
    spec-dod.md            (DoD checklist — must pass before Architect dispatch)
    requirements.md        (spec quality checklist, generated by Spec Agent)
```

## Pipeline Artifact Folder Convention

All pipeline artifacts for a feature live under `<SHOP_ROOT>/reports/pipeline/`:

```
<SHOP_ROOT>/reports/pipeline/<NNN>-<feature-name>/
  .pipeline-state.md       (Coordinator state — created at spec time, updated every stage)
  adr.md                   (architecture decision record)
  research.md              (if produced by Architect)
  tasks.md                 (generated by Coordinator after ADR approval)
  test-certification.md    (generated by TDD Agent)
  red-team-findings.md     (generated by Red-Team Agent — audit trail)
```

`<NNN>` is a zero-padded three-digit FEAT number (001, 002, ...). `<feature-name>` is 2–4 words, lowercase-hyphenated. Example: `reports/pipeline/003-csv-invoice-export/`. Scan existing `reports/pipeline/` folders for the next available number — never reuse. The `spec_path` field in `.pipeline-state.md` records where the corresponding spec files live.

---

## Reports Folder Convention

All agent reports live under a single centralized folder. This is the single source of truth for everything agents produce outside of spec artifacts. The subdirectory structure is pre-created in the repo — agents can write directly without creating directories.

```
<SHOP_ROOT>/reports/
  pipeline/
    <NNN>-<feature-name>/    (per-feature — see Pipeline Artifact Folder Convention above)
  codebase-analysis/
    ANALYSIS-<id>-<YYYY-MM-DD>.md     (CodeBase Analyzer — findings report)
    MIGRATION-<id>-<YYYY-MM-DD>.md    (CodeBase Analyzer — migration plan, if requested)
  test-runs/
    TESTRUN-<feature-id>-<YYYY-MM-DD-HHmm>.md  (TestRunner — one file per run, never overwritten)
  security/
    SEC-<feature-id>-<YYYY-MM-DD>.md  (Security Agent — threat findings)
  code-review/
    CR-<feature-id>-<YYYY-MM-DD>.md   (Code Review Agent — findings)
  observer/
    timeline-CYCLE-<NNN>.md           (Observer — per-cycle timeline log)
    pattern-report-<YYYY-WNN>.md      (Observer — weekly pattern report)
```

**Rules:**
- All agents write reports here — do not scatter report files elsewhere
- Test run reports are timestamped and never overwritten — each run is a separate audit artifact
- The Programmer reads test state by running tests fresh, not by reading reports — reports are audit trail only
- Spec files (feature.spec.md and .spec.ts contracts) live at the user-specified location, not in reports/
- Pipeline artifacts (adr.md, tasks.md, test-certification.md, red-team-findings.md) live in `reports/pipeline/<NNN>-<feature-name>/`, not scattered elsewhere
